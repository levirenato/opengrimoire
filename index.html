<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>D&D 5e Character Sheet</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Merriweather:wght@300;400;700&display=swap"
    rel="stylesheet">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <input type="file" id="import-input" accept=".json" style="display: none;" onchange="importCharacter(this)">

  <!-- DASHBOARD -->
  <div id="dashboard" class="main-container">
    <header class="app-header">
      <h1 class="title-fantasy">Grimório de Lendas</h1>
      <p class="subtitle">Gerencie seus heróis e suas histórias</p>
      <button class="theme-toggle-btn" onclick="toggleGlobalTheme()" title="Alternar Tema Claro/Escuro">
        <span class="material-icons-round" id="theme-icon-home">light_mode</span>
      </button>
    </header>
    <button onclick="createNewCharacter()" class="btn-hero neon-effect">
      <span class="material-icons-round">add_circle</span> Criar Novo Personagem
    </button>
    <div class="char-grid-list" id="character-list"></div>
  </div>

  <!-- SHEET EDITOR -->
  <div id="sheet-editor" class="sheet-container hidden">
    <nav class="toolbar surface-elevated">
      <div class="nav-left">
        <button class="btn-icon" onclick="closeCharacter()">
          <span class="material-icons-round">arrow_back</span> Voltar
        </button>
        <button class="btn-icon" onclick="toggleGlobalTheme()" title="Alternar Tema Claro/Escuro">
          <span class="material-icons-round" id="theme-icon-sheet">light_mode</span>
        </button>
      </div>
      <div class="toolbar-actions">
        <button class="btn-secondary" onclick="exportToPDF()">
          <span class="material-icons-round">picture_as_pdf</span> PDF
        </button>
        <button class="btn-secondary" onclick="exportCharacter()">
          <span class="material-icons-round">download</span> JSON
        </button>
        <button class="btn-secondary" onclick="document.getElementById('import-input').click()">
          <span class="material-icons-round">upload</span> Importar
        </button>
        <button class="btn-primary" onclick="saveCharacter()">
          <span class="material-icons-round">save</span> Salvar
        </button>
        <button class="btn-danger icon-only" onclick="deleteCharacter()">
          <span class="material-icons-round">delete</span>
        </button>
      </div>
    </nav>

    <form id="char-form" class="sheet-layout-new">
      <!-- HEADER DA FICHA -->
      <section class="sheet-header-new surface-elevated">
        <div class="header-top-row">
          <div class="char-portrait-container">
            <div class="portrait-frame-new" onclick="document.getElementById('portrait-upload').click()">
              <img id="char-portrait" src="" alt="Portrait" class="hidden">
              <div id="portrait-placeholder" class="portrait-placeholder-new">
                <span class="material-icons-round">add_a_photo</span>
              </div>
            </div>
            <input type="file" id="portrait-upload" accept="image/*" style="display:none"
              onchange="handlePortraitUpload(event)">
          </div>

          <div class="header-info-group">
            <div class="char-name-wrapper">
              <input type="text" name="charName" class="input-char-name" placeholder="Nome do Personagem">
              <div class="char-color-picker-inline">
                <input type="hidden" name="charColor" id="charColorInput">
                <div class="color-dots-inline">
                  <span class="dot" style="background:#b8860b" onclick="setCharColor('#b8860b')"></span>
                  <span class="dot" style="background:#E7623E" onclick="setCharColor('#E7623E')"></span>
                  <span class="dot" style="background:#AB6DAC" onclick="setCharColor('#AB6DAC')"></span>
                  <span class="dot" style="background:#91A1B2" onclick="setCharColor('#91A1B2')"></span>
                  <span class="dot" style="background:#7A853B" onclick="setCharColor('#7A853B')"></span>
                  <span class="dot" style="background:#7F513E" onclick="setCharColor('#7F513E')"></span>
                  <span class="dot" style="background:#51A5C5" onclick="setCharColor('#51A5C5')"></span>
                  <span class="dot" style="background:#B59E54" onclick="setCharColor('#B59E54')"></span>
                </div>
              </div>
            </div>

            <div class="header-meta-grid">
              <div class="meta-field">
                <label>Classe</label>
                <input type="text" name="charClass" placeholder="Classe">
              </div>
              <div class="meta-field">
                <label>Nível</label>
                <input type="number" name="level" placeholder="1" class="input-small">
              </div>
              <div class="meta-field">
                <label>Raça</label>
                <input type="text" name="species" placeholder="Raça">
              </div>
              <div class="meta-field">
                <label>Antecedente</label>
                <input type="text" name="background" placeholder="Antecedente">
              </div>
              <div class="meta-field">
                <label>Subclasse</label>
                <input type="text" name="subclass" placeholder="Subclasse">
              </div>
              <div class="meta-field">
                <label>Alinhamento</label>
                <input type="text" name="alignment" placeholder="Alinhamento">
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- CORPO PRINCIPAL DA FICHA -->
      <div class="sheet-body-grid">

        <!-- COLUNA ESQUERDA: ATRIBUTOS -->
        <aside class="left-sidebar">
          <!-- Atributos -->
          <div class="attributes-section surface-elevated">
            <h3 class="section-title-small">Atributos</h3>
            <div class="attributes-list">
              <div class="attr-item">
                <label>FOR</label>
                <input type="text" name="str_mod" class="attr-mod" readonly>
                <input type="number" name="str_score" class="attr-score" placeholder="10" oninput="updateModifiers()">
              </div>
              <div class="attr-item">
                <label>DES</label>
                <input type="text" name="dex_mod" class="attr-mod" readonly>
                <input type="number" name="dex_score" class="attr-score" placeholder="10" oninput="updateModifiers()">
              </div>
              <div class="attr-item">
                <label>CON</label>
                <input type="text" name="con_mod" class="attr-mod" readonly>
                <input type="number" name="con_score" class="attr-score" placeholder="10" oninput="updateModifiers()">
              </div>
              <div class="attr-item">
                <label>INT</label>
                <input type="text" name="int_mod" class="attr-mod" readonly>
                <input type="number" name="int_score" class="attr-score" placeholder="10" oninput="updateModifiers()">
              </div>
              <div class="attr-item">
                <label>SAB</label>
                <input type="text" name="wis_mod" class="attr-mod" readonly>
                <input type="number" name="wis_score" class="attr-score" placeholder="10" oninput="updateModifiers()">
              </div>
              <div class="attr-item">
                <label>CAR</label>
                <input type="text" name="cha_mod" class="attr-mod" readonly>
                <input type="number" name="cha_score" class="attr-score" placeholder="10" oninput="updateModifiers()">
              </div>
            </div>

            <div class="bonus-inspiration-row">
              <div class="small-box">
                <label>Inspiração</label>
                <input type="checkbox" name="inspiration" class="check-large">
              </div>
              <div class="small-box">
                <label>Bônus Prof.</label>
                <input type="text" name="profBonus" placeholder="+2">
              </div>
            </div>

            <div class="passive-box">
              <label>Percepção Passiva</label>
              <input type="number" name="passivePerception" placeholder="10">
            </div>
          </div>

          <!-- Testes de Resistência -->
          <div class="saves-section surface-elevated">
            <h3 class="section-title-small">Resistências</h3>
            <div class="save-item">
              <label><input type="checkbox" name="save_str_prof"><span>Força</span></label>
              <input type="text" name="save_str_mod" placeholder="+0">
            </div>
            <div class="save-item">
              <label><input type="checkbox" name="save_dex_prof"><span>Destreza</span></label>
              <input type="text" name="save_dex_mod" placeholder="+0">
            </div>
            <div class="save-item">
              <label><input type="checkbox" name="save_con_prof"><span>Constituição</span></label>
              <input type="text" name="save_con_mod" placeholder="+0">
            </div>
            <div class="save-item">
              <label><input type="checkbox" name="save_int_prof"><span>Inteligência</span></label>
              <input type="text" name="save_int_mod" placeholder="+0">
            </div>
            <div class="save-item">
              <label><input type="checkbox" name="save_wis_prof"><span>Sabedoria</span></label>
              <input type="text" name="save_wis_mod" placeholder="+0">
            </div>
            <div class="save-item">
              <label><input type="checkbox" name="save_cha_prof"><span>Carisma</span></label>
              <input type="text" name="save_cha_mod" placeholder="+0">
            </div>
          </div>

          <!-- Perícias -->
          <div class="skills-section surface-elevated">
            <h3 class="section-title-small">Perícias</h3>
            <div class="skills-scroll">
              <div class="skill-item">
                <label><input type="checkbox" name="skill_acro_prof"><span>Acrobacia</span></label>
                <input type="text" name="skill_acro_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_anim_prof"><span>Adestrar Animais</span></label>
                <input type="text" name="skill_anim_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_arca_prof"><span>Arcanismo</span></label>
                <input type="text" name="skill_arca_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_athl_prof"><span>Atletismo</span></label>
                <input type="text" name="skill_athl_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_perf_prof"><span>Atuação</span></label>
                <input type="text" name="skill_perf_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_decp_prof"><span>Enganação</span></label>
                <input type="text" name="skill_decp_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_stea_prof"><span>Furtividade</span></label>
                <input type="text" name="skill_stea_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_hist_prof"><span>História</span></label>
                <input type="text" name="skill_hist_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_inti_prof"><span>Intimidação</span></label>
                <input type="text" name="skill_inti_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_insg_prof"><span>Intuição</span></label>
                <input type="text" name="skill_insg_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_invs_prof"><span>Investigação</span></label>
                <input type="text" name="skill_invs_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_medi_prof"><span>Medicina</span></label>
                <input type="text" name="skill_medi_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_natu_prof"><span>Natureza</span></label>
                <input type="text" name="skill_natu_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_perc_prof"><span>Percepção</span></label>
                <input type="text" name="skill_perc_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_pers_prof"><span>Persuasão</span></label>
                <input type="text" name="skill_pers_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_slei_prof"><span>Prestidigitação</span></label>
                <input type="text" name="skill_slei_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_reli_prof"><span>Religião</span></label>
                <input type="text" name="skill_reli_mod" placeholder="+0">
              </div>
              <div class="skill-item">
                <label><input type="checkbox" name="skill_surv_prof"><span>Sobrevivência</span></label>
                <input type="text" name="skill_surv_mod" placeholder="+0">
              </div>
            </div>
          </div>
        </aside>

        <!-- COLUNA CENTRAL: COMBATE E PRINCIPAIS -->
        <main class="center-main">
          <!-- Stats de Combate -->
          <div class="combat-row surface-elevated">
            <div class="combat-stat">
              <span class="material-symbols-outlined">shield</span>
              <label>CA</label>
              <input type="number" name="ac" placeholder="10">
            </div>
            <div class="combat-stat">
              <span class="material-symbols-outlined">electric_bolt</span>
              <label>Iniciativa</label>
              <input type="text" name="initiative" placeholder="+0">
            </div>
            <div class="combat-stat">
              <span class="material-symbols-outlined">footprint</span>
              <label>Deslocamento</label>
              <input type="text" name="speed" placeholder="9m">
            </div>
          </div>

          <!-- HP -->
          <div class="hp-section-new surface-elevated">
            <div class="hp-header">
              <span class="material-symbols-outlined">favorite</span>
              <label>Pontos de Vida</label>
            </div>
            <div class="hp-inputs">
              <div class="hp-field">
                <label>Máximo</label>
                <input type="number" name="hpMax" placeholder="0">
              </div>
              <div class="hp-field hp-current-field">
                <label>Atual</label>
                <input type="number" name="hpCurrent" placeholder="0" class="hp-current-input">
              </div>
              <div class="hp-field">
                <label>Temp</label>
                <input type="number" name="hpTemp" placeholder="0">
              </div>
            </div>
          </div>

          <!-- Hit Dice e Death Saves -->
          <div class="dice-death-row">
            <div class="hit-dice-box surface-elevated">
              <label>Dados de Vida</label>
              <input type="text" name="hitDiceTotal" placeholder="1d8">
            </div>
            <div class="death-saves-box surface-elevated">
              <label>Testes contra Morte</label>
              <div class="death-checks">
                <div class="death-row">
                  <span>Sucesso</span>
                  <div class="check-group">
                    <input type="checkbox"><input type="checkbox"><input type="checkbox">
                  </div>
                </div>
                <div class="death-row">
                  <span>Falha</span>
                  <div class="check-group">
                    <input type="checkbox"><input type="checkbox"><input type="checkbox">
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Ataques e Equipamento -->
          <div class="tabs-wrapper">
            <div class="tabs-header">
              <button type="button" class="tab-button active" onclick="switchTab(event, 'attacks-tab')">Ataques</button>
              <button type="button" class="tab-button" onclick="switchTab(event, 'equipment-tab')">Equipamento</button>
              <button type="button" class="tab-button" onclick="switchTab(event, 'features-tab')">Traços</button>
            </div>

            <div id="attacks-tab" class="tab-panel active surface-elevated">
              <label class="tab-label">Ataques e Conjuração</label>
              <p class="helper-small">Nome | Bônus | Dano/Tipo</p>
              <textarea name="attacks" rows="8" placeholder="Ex: Espada Longa | +5 | 1d8+3 cortante"></textarea>
            </div>

            <div id="equipment-tab" class="tab-panel surface-elevated">
              <div class="coins-row">
                <div class="coin"><label>PC</label><input type="number" name="cp" placeholder="0"></div>
                <div class="coin"><label>PP</label><input type="number" name="sp" placeholder="0"></div>
                <div class="coin"><label>PE</label><input type="number" name="ep" placeholder="0"></div>
                <div class="coin"><label>PO</label><input type="number" name="gp" placeholder="0"></div>
                <div class="coin"><label>PL</label><input type="number" name="pp" placeholder="0"></div>
              </div>
              <label class="tab-label">Equipamento</label>
              <textarea name="equipment" rows="10" placeholder="Liste seus itens..."></textarea>
            </div>

            <div id="features-tab" class="tab-panel surface-elevated">
              <label class="tab-label">Proficiências e Idiomas</label>
              <textarea name="proficiencies" rows="4"
                placeholder="Armaduras, armas, ferramentas, idiomas..."></textarea>
              <label class="tab-label">Características e Talentos</label>
              <textarea name="featuresTraits" rows="10" placeholder="Descreva suas habilidades especiais..."></textarea>
            </div>
          </div>
        </main>

        <!-- COLUNA DIREITA: MAGIAS -->
        <aside class="right-sidebar">
          <div class="spells-section surface-elevated">
            <h3 class="section-title-small">Magias</h3>

            <div class="spell-stats-row">
              <div class="spell-stat-mini">
                <label>Hab.</label>
                <input type="text" name="spellcastingAbility" placeholder="INT">
              </div>
              <div class="spell-stat-mini">
                <label>CD</label>
                <input type="number" name="spellSaveDC" placeholder="13">
              </div>
              <div class="spell-stat-mini">
                <label>Atq.</label>
                <input type="text" name="spellAttackBonus" placeholder="+5">
              </div>
            </div>

            <div class="spell-level-block">
              <h4>Truques</h4>
              <textarea name="spells_cantrips" rows="3" placeholder="Um por linha"></textarea>
            </div>

            <div class="spell-level-block">
              <div class="spell-level-header">
                <h4>Nível 1</h4>
                <div class="slots">
                  <input type="number" name="slots_lvl1_total" placeholder="0" class="slot-input">
                  <span>/</span>
                  <input type="number" name="slots_lvl1_used" placeholder="0" class="slot-input">
                </div>
              </div>
              <textarea name="spells_lvl1" rows="3" placeholder="Um por linha"></textarea>
            </div>

            <div class="spell-level-block">
              <div class="spell-level-header">
                <h4>Nível 2</h4>
                <div class="slots">
                  <input type="number" name="slots_lvl2_total" placeholder="0" class="slot-input">
                  <span>/</span>
                  <input type="number" name="slots_lvl2_used" placeholder="0" class="slot-input">
                </div>
              </div>
              <textarea name="spells_lvl2" rows="3" placeholder="Um por linha"></textarea>
            </div>

            <div class="spell-level-block">
              <div class="spell-level-header">
                <h4>Nível 3</h4>
                <div class="slots">
                  <input type="number" name="slots_lvl3_total" placeholder="0" class="slot-input">
                  <span>/</span>
                  <input type="number" name="slots_lvl3_used" placeholder="0" class="slot-input">
                </div>
              </div>
              <textarea name="spells_lvl3" rows="3" placeholder="Um por linha"></textarea>
            </div>
          </div>

          <!-- História -->
          <div class="backstory-section surface-elevated">
            <h3 class="section-title-small">História do Personagem</h3>
            <textarea name="backstory" rows="8" placeholder="Conte a história do seu personagem..."></textarea>
          </div>
        </aside>
      </div>
    </form>
  </div>

  <footer>
    <small>Copyright &copy; 2025 created by levirenato.</small>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <script src="script.js"></script>
  <script src="pdf-exporter.js"></script>
</body>

</html>
